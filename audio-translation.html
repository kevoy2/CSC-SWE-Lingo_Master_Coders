<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speech to Text Translation</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="top-nav">
        <button id="menu-toggle" class="menu-btn">
            <span class="menu-icon"></span>
        </button>
        <div class="nav-links">
            <a href="translation.html">Home</a>
            <a href="about.html">About</a>
            <a href="contact.html">Contact</a>
        </div>
    </nav>

    <main class="container" role="main">
        <h1>Speech to Text Translation</h1>
        <div class="translation-box">
    
            <div class="textarea-wrapper">
                <textarea id="source-text" placeholder="Speech will appear here" maxlength="1000"></textarea>
                <div class="textarea-controls">
                    <button class="icon-button" onclick="startSpeechRecognition()" aria-label="Start Speech Recognition">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button class="icon-button" id="clear-text" onclick="clearText()" aria-label="Clear text">CLEAR</button>
                </div>
                <div id="char-count">0/1000</div>
            </div>

            <div class="language-selection">
       
                <select id="source-language">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="zh-CN">Chinese Simplified</option>
                    <option value="ar">Arabic</option>
                    <option value="ru">Russian</option>
                    <option value="de">German</option>
                    <option value="pt">Portuguese</option>
                    <option value="hi">Hindi</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="it">Italian</option>
                    <option value="nl">Dutch</option>
                    <option value="tr">Turkish</option>
                    <option value="uk">Ukrainian</option>
                </select>
    
                <select id="target-language">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="zh-CN">Chinese Simplified</option>
                    <option value="ar">Arabic</option>
                    <option value="ru">Russian</option>
                    <option value="de">German</option>
                    <option value="pt">Portuguese</option>
                    <option value="hi">Hindi</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="it">Italian</option>
                    <option value="nl">Dutch</option>
                    <option value="tr">Turkish</option>
                    <option value="uk">Ukrainian</option>
                </select>
            </div>

            <button id="translate-button" onclick="translateText()">Translate</button>

            <div class="textarea-wrapper">
                <textarea id="translated-text" readonly placeholder="Translation will appear here"></textarea>
            </div>
        </div>
    </main>

    <footer>
        &#xA9; 2024 LingoScape. All rights reserved.
    </footer>

    <script>
    
        let recognition;

        function startSpeechRecognition() {
            if (!('webkitSpeechRecognition' in window)) {
                alert("Sorry, your browser doesn't support speech recognition.");
                return;
            }

            recognition = new webkitSpeechRecognition();
            recognition.lang = document.getElementById('source-language').value;
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('source-text').value = transcript;
                updateCharCount();
                translateText(); 
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event);
                alert('Speech recognition error');
            };

            recognition.start();
        }

        function updateCharCount() {
            const sourceText = document.getElementById('source-text').value;
            document.getElementById('char-count').textContent = `${sourceText.length}/1000`;
        }

        function clearText() {
            document.getElementById('source-text').value = '';
            document.getElementById('translated-text').value = '';
            updateCharCount();
        }

        function translateText() {
            const sourceText = document.getElementById('source-text').value;
            const fromLang = document.getElementById('source-language').value;
            const toLang = document.getElementById('target-language').value;
            const apiUrl = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(sourceText)}&langpair=${fromLang}|${toLang}`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('translated-text').value = data.responseData.translatedText;
                })
                .catch(error => {
                    console.error('Translation error:', error);
                    document.getElementById('translated-text').value = 'Error: Could not translate text';
                });
        }
    </script>
</body>
</html>